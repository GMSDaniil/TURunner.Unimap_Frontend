// export 'route_timeline.dart';
//                 Padding(
//                   padding: const EdgeInsets.fromLTRB(20, 12, 20, 0),
//                   child: Row(
//                     children: [
//                       Expanded(
//                         child: Text(
//                           'Route details',
//                           style: Theme.of(context).textTheme.titleLarge!.copyWith(
//                                 fontWeight: FontWeight.w700,
//                               ),
//                         ),
//                       ),
//                       Container(
//                         width: 36,
//                         height: 36,
//                         decoration: BoxDecoration(
//                           color: Colors.grey.shade200,
//                           shape: BoxShape.circle,
//                         ),
//                         child: IconButton(
//                           padding: EdgeInsets.zero,
//                           icon: const Icon(Icons.arrow_back, size: 18),
//                           splashRadius: 18,
//                           onPressed: onClose,
//                         ),
//                       ),
//                     ],
//                   ),
//                 ),
//                 const SizedBox(height: 24),
//                 Expanded(
//                   child: NotificationListener<ScrollNotification>(
//                     onNotification: (notification) {
//                       if (notification is OverscrollNotification &&
//                           notification.overscroll < 0 &&
//                           scrollController.position.pixels <= 0) {
//                         onClose();
//                         return true;
//                       }
//                       return false;
//                     },
//                     child: SingleChildScrollView(
//                       controller: scrollController,
//                       padding: const EdgeInsets.fromLTRB(20, 0, 20, 28),
//                       child: Builder(
//                         builder: (ctx) {
//                           if (segs.isEmpty) {
//                             return Padding(
//                               padding: const EdgeInsets.symmetric(vertical: 16),
//                               child: Center(
//                                 child: Text('No route segments', style: Theme.of(ctx).textTheme.bodyMedium),
//                               ),
//                             );
//                           }
//                           return Column(
//                             crossAxisAlignment: CrossAxisAlignment.start,
//                             children: [
//                               Row(
//                                 crossAxisAlignment: CrossAxisAlignment.start,
//                                 children: [
//                                   Container(
//                                     width: 32,
//                                     child: Column(
//                                       children: [
//                                         Container(
//                                           width: 20,
//                                           height: 20,
//                                           decoration: BoxDecoration(
//                                             color: Colors.white,
//                                             border: Border.all(
//                                               color: Colors.grey.shade400,
//                                               width: 3,
//                                             ),
//                                             shape: BoxShape.circle,
//                                           ),
//                                           child: Center(
//                                             child: Icon(Icons.flag, size: 12, color: Colors.grey.shade400),
//                                           ),
//                                         ),
//                                         Container(
//                                           width: 4,
//                                           height: 32,
//                                           color: Colors.grey.shade400,
//                                         ),
//                                       ],
//                                     ),
//                                   ),
//                                   Expanded(
//                                     child: Container(
//                                       margin: const EdgeInsets.only(bottom: 8),
//                                       padding: const EdgeInsets.symmetric(vertical: 8, horizontal: 12),
//                                       decoration: BoxDecoration(
//                                         color: Theme.of(context).colorScheme.surfaceVariant,
//                                         borderRadius: BorderRadius.circular(14),
//                                       ),
//                                       child: Text(
//                                         deriveStartName(data),
//                                         style: const TextStyle(fontWeight: FontWeight.w600, fontSize: 16),
//                                       ),
//                                     ),
//                                   ),
//                                 ],
//                               ),
//                               for (int i = 0; i < segs.length; i++)
//                                 // Inline copy of _SegmentTimelineTile to avoid import issues
//                                 Row(
//                                   crossAxisAlignment: CrossAxisAlignment.start,
//                                   children: [
//                                     Container(
//                                       width: 32,
//                                       child: Column(
//                                         children: [
//                                           if (i != 0)
//                                             Container(
//                                               width: 4,
//                                               height: 16,
//                                           color: segs[i].transportType == 'bus'
//                                               ? Theme.of(context).colorScheme.primary
//                                               : segs[i].transportType == 'subway'
//                                                   ? Colors.blue.shade700
//                                                   : segs[i].transportType == 'suburban'
//                                                       ? Color(0xFF388E3C)
//                                                       : Colors.grey.shade400,
//                                             ),
//                                           Container(
//                                             width: 20,
//                                             height: 20,
//                                             decoration: BoxDecoration(
//                                           color: segs[i].transportType == 'bus'
//                                               ? Theme.of(context).colorScheme.primary
//                                               : segs[i].transportType == 'subway'
//                                                   ? Colors.blue.shade700
//                                                   : segs[i].transportType == 'suburban'
//                                                       ? Color(0xFF388E3C)
//                                                       : Colors.white,
//                                           border: Border.all(
//                                             color: segs[i].transportType == 'bus'
//                                                 ? Theme.of(context).colorScheme.primary
//                                                 : segs[i].transportType == 'subway'
//                                                     ? Colors.blue.shade700
//                                                     : segs[i].transportType == 'suburban'
//                                                         ? Color(0xFF388E3C)
//                                                         : Colors.grey.shade400,
//                                             width: 3,
//                                           ),
//                                               shape: BoxShape.circle,
//                                             ),
//                                             child: Center(
//                                           child: segs[i].transportType == 'bus'
//                                               ? Icon(Icons.directions_bus, size: 12, color: Colors.white)
//                                               : segs[i].transportType == 'subway'
//                                                   ? Icon(Icons.subway, size: 12, color: Colors.white)
//                                                   : segs[i].transportType == 'suburban'
//                                                       ? Icon(Icons.train, size: 12, color: Colors.white)
//                                                       : Icon(Icons.directions_walk, size: 12, color: segs[i].transportType == 'bus'
//                                                           ? Theme.of(context).colorScheme.primary
//                                                           : segs[i].transportType == 'subway'
//                                                               ? Colors.blue.shade700
//                                                               : segs[i].transportType == 'suburban'
//                                                                   ? Color(0xFF388E3C)
//                                                                   : Colors.grey.shade400),
//                                             ),
//                                           ),
//                                           if (i != segs.length - 1)
//                                             Container(
//                                               width: 4,
//                                               height: 32,
//                                               color: segs[i].transportType == 'bus'
//                                                   ? Theme.of(context).colorScheme.primary
//                                                   : segs[i].transportType == 'subway'
//                                                       ? Colors.blue.shade700
//                                                       : Colors.grey.shade400,
//                                             ),
//                                         ],
//                                       ),
//                                     ),
//                                     Expanded(
//                                       child: Container(
//                                         margin: const EdgeInsets.only(bottom: 8),
//                                         padding: const EdgeInsets.symmetric(vertical: 8, horizontal: 12),
//                                         decoration: BoxDecoration(
//                                           color: Theme.of(context).colorScheme.surfaceVariant,
//                                           borderRadius: BorderRadius.circular(14),
//                                         ),
//                                         child: (() {
//                                           final segment = segs[i];
//                                           final isBus = segment.transportType == 'bus';
//                                           final isSubway = segment.transportType == 'subway';
//                                           final isSuburban = segment.transportType == 'suburban';
//                                           final Color pillColor = isBus
//                                               ? Theme.of(context).colorScheme.primary
//                                               : isSubway
//                                                   ? Colors.blue.shade700
//                                                   : isSuburban
//                                                       ? Color(0xFF388E3C)
//                                                       : Colors.grey.shade400;
//                                           if (isBus || isSubway || isSuburban) {
//                                             return Column(
//                                               crossAxisAlignment: CrossAxisAlignment.start,
//                                               children: [
//                                                 Row(
//                                                   children: [
//                                                     if (segment.transportLine != null)
//                                                       Container(
//                                                         padding: const EdgeInsets.symmetric(horizontal: 8, vertical: 2),
//                                                         margin: const EdgeInsets.only(right: 8),
//                                                         decoration: BoxDecoration(
//                                                           color: pillColor,
//                                                           borderRadius: BorderRadius.circular(8),
//                                                         ),
//                                                         child: Text(
//                                                           segment.transportLine!,
//                                                           style: const TextStyle(
//                                                             color: Colors.white,
//                                                             fontWeight: FontWeight.bold,
//                                                             fontSize: 13,
//                                                           ),
//                                                         ),
//                                                       ),
//                                                     Expanded(
//                                                       child: Text(
//                                                         segment.toStop ?? (isBus ? 'Bus segment' : isSubway ? 'Subway segment' : isSuburban ? 'S-Bahn segment' : ''),
//                                                         style: const TextStyle(
//                                                           fontWeight: FontWeight.w600,
//                                                           fontSize: 15,
//                                                         ),
//                                                       ),
//                                                     ),
//                                                     Text(
//                                                       ((segment.durrationSeconds / 60).round()).toString() + ' min',
//                                                       style: TextStyle(
//                                                         color: pillColor,
//                                                         fontWeight: FontWeight.w500,
//                                                       ),
//                                                     ),
//                                                   ],
//                                                 ),
//                                                 if (segment.fromStop != null && segment.fromStop!.trim().isNotEmpty)
//                                                   Padding(
//                                                     padding: const EdgeInsets.only(top: 2.0),
//                                                     child: Text(
//                                                       'Board at: ${segment.fromStop}',
//                                                       style: TextStyle(
//                                                         color: Colors.grey.shade700,
//                                                         fontSize: 13,
//                                                       ),
//                                                     ),
//                                                   ),
//                                               ],
//                                             );
//                                           } else {
//                                             return Row(
//                                               children: [
//                                                 Icon(Icons.directions_walk, size: 16, color: Colors.grey.shade700),
//                                                 const SizedBox(width: 8),
//                                                 Expanded(
//                                                   child: Text(
//                                                     'Walk ' + ((segment.durrationSeconds / 60).round()).toString() + ' min (' + (segment.distanceMeters >= 1000 ? (segment.distanceMeters / 1000).toStringAsFixed(1) + ' km' : segment.distanceMeters.round().toString() + ' m') + ')',
//                                                     style: const TextStyle(fontSize: 14, fontWeight: FontWeight.w500),
//                                                   ),
//                                                 ),
//                                               ],
//                                             );
//                                           }
//                                         })(),
//                                       ),
//                                     ),
//                                   ],
//                                 ),
//                               Row(
//                                 crossAxisAlignment: CrossAxisAlignment.start,
//                                 children: [
//                                   Container(
//                                     width: 32,
//                                     child: Column(
//                                       children: [
//                                         Container(
//                                           width: 4,
//                                           height: 32,
//                                           color: Colors.grey.shade400,
//                                         ),
//                                         Container(
//                                           width: 20,
//                                           height: 20,
//                                           decoration: BoxDecoration(
//                                             color: Colors.white,
//                                             border: Border.all(
//                                               color: Colors.grey.shade400,
//                                               width: 3,
//                                             ),
//                                             shape: BoxShape.circle,
//                                           ),
//                                           child: Center(
//                                             child: Icon(Icons.flag, size: 12, color: Colors.grey.shade400),
//                                           ),
//                                         ),
//                                       ],
//                                     ),
//                                   ),
//                                   Expanded(
//                                     child: Container(
//                                       margin: const EdgeInsets.only(bottom: 8),
//                                       padding: const EdgeInsets.symmetric(vertical: 8, horizontal: 12),
//                                       decoration: BoxDecoration(
//                                         color: Theme.of(context).colorScheme.surfaceVariant,
//                                         borderRadius: BorderRadius.circular(14),
//                                       ),
//                                       child: Text(
//                                         deriveEndName(data),
//                                         style: const TextStyle(fontWeight: FontWeight.w600, fontSize: 16),
//                                       ),
//                                     ),
//                                   ),
//                                 ],
//                               ),
//                             ],
//                           );
//                         },
//                       ),
//                     ),
//                   ),
//                 ),
//               ],
//             ),
//           ),
//         ),
//       ),
//     );
    
//   }
// }

// class _NoGlowScrollBehavior extends ScrollBehavior {
//   const _NoGlowScrollBehavior();

//   @override
//   Widget buildOverscrollIndicator(BuildContext context, Widget child, ScrollableDetails details) {
//     return child;
//   }
// }

// // Import _SegmentTimelineTile from route_options_sheet.dart
// // import 'package:auth_app/data/models/route_data.dart';
// // import 'package:auth_app/data/models/route_segment.dart';


// // // Use the TravelMode enum from your main app if available, otherwise define here.
// // enum TravelMode { walk, bus, scooter }

// // // --- Timeline endpoint tile (start/end) ---
// // class _RouteEndpointTile extends StatelessWidget {
// //   final String label;
// //   final String location;
// //   final bool isFirst;
// //   final bool isLast;

// //   const _RouteEndpointTile({
// //     required this.label,
// //     required this.location,
// //     required this.isFirst,
// //     required this.isLast,
// //   });

// //   @override
// //   Widget build(BuildContext context) {
// //     final theme = Theme.of(context);
// //     return Row(
// //       crossAxisAlignment: CrossAxisAlignment.start,
// //       children: [
// //         Container(
// //           width: 32,
// //           child: Column(
// //             children: [
// //               if (!isFirst)
// //                 Container(
// //                   width: 4,
// //                   height: 16,
// //                   color: Colors.grey.shade400,
// //                 ),
// //               Container(
// //                 width: 20,
// //                 height: 20,
// //                 decoration: BoxDecoration(
// //                   color: theme.colorScheme.primary,
// //                   border: Border.all(
// //                     color: theme.colorScheme.primary,
// //                     width: 3,
// //                   ),
// //                   shape: BoxShape.circle,
// //                 ),
// //                 child: Center(
// //                   child: Icon(
// //                     isFirst ? Icons.circle : Icons.flag,
// //                     size: 12,
// //                     color: Colors.white,
// //                   ),
// //                 ),
// //               ),
// //               if (!isLast)
// //                 Container(
// //                   width: 4,
// //                   height: 32,
// //                   color: Colors.grey.shade400,
// //                 ),
// //             ],
// //           ),
// //         ),
// //         Expanded(
// //           child: Container(
// //             margin: const EdgeInsets.only(bottom: 8),
// //             padding: const EdgeInsets.symmetric(vertical: 8, horizontal: 12),
// //             decoration: BoxDecoration(
// //               color: theme.colorScheme.surfaceVariant,
// //               borderRadius: BorderRadius.circular(14),
// //             ),
// //             child: Text(
// //               location,
// //               style: const TextStyle(
// //                 fontWeight: FontWeight.w600,
// //                 fontSize: 15,
// //               ),
// //             ),
// //           ),
// //         ),
// //       ],
// //     );
// //   }
// // }

// // // --- Timeline segment tile ---
// // class _SegmentTimelineTile extends StatelessWidget {
// //   final RouteSegment segment;
// //   final bool isFirst;
// //   final bool isLast;

// //   const _SegmentTimelineTile({
// //     required this.segment,
// //     required this.isFirst,
// //     required this.isLast,
// //   });

// //   @override
// //   Widget build(BuildContext context) {
// //     final isBus = segment.mode.toString().contains('bus');
// //     final theme = Theme.of(context);
// //     final Color timelineColor = isBus
// //         ? theme.colorScheme.primary
// //         : Colors.grey.shade400;

// //     return Row(
// //       crossAxisAlignment: CrossAxisAlignment.start,
// //       children: [
// //         // Timeline
// //         Container(
// //           width: 32,
// //           child: Column(
// //             children: [
// //               if (!isFirst)
// //                 Container(
// //                   width: 4,
// //                   height: 16,
// //                   color: timelineColor,
// //                 ),
// //               Container(
// //                 width: 20,
// //                 height: 20,
// //                 decoration: BoxDecoration(
// //                   color: isBus ? theme.colorScheme.primary : Colors.white,
// //                   border: Border.all(
// //                     color: timelineColor,
// //                     width: 3,
// //                   ),
// //                   shape: BoxShape.circle,
// //                 ),
// //                 child: Center(
// //                   child: Icon(
// //                     isBus ? Icons.directions_bus : Icons.directions_walk,
// //                     size: 12,
// //                     color: isBus ? Colors.white : timelineColor,
// //                   ),
// //                 ),
// //               ),
// //               if (!isLast)
// //                 Container(
// //                   width: 4,
// //                   height: 32,
// //                   color: timelineColor,
// //                 ),
// //             ],
// //           ),
// //         ),
// //         // Content
// //         Expanded(
// //           child: Container(
// //             margin: const EdgeInsets.only(bottom: 8),
// //             padding: const EdgeInsets.symmetric(vertical: 8, horizontal: 12),
// //             decoration: BoxDecoration(
// //               color: theme.colorScheme.surfaceVariant,
// //               borderRadius: BorderRadius.circular(14),
// //             ),
// //             child: _buildSegmentContent(context, isBus),
// //           ),
// //         ),
// //       ],
// //     );
// //   }

// //   Widget _buildSegmentContent(BuildContext context, bool isBus) {
// //     final theme = Theme.of(context);
// //     if (isBus) {
// //       return Column(
// //         crossAxisAlignment: CrossAxisAlignment.start,
// //         children: [
// //           Row(
// //             children: [
// //               if (segment.transportLine != null)
// //                 Container(
// //                   padding: const EdgeInsets.symmetric(horizontal: 8, vertical: 2),
// //                   margin: const EdgeInsets.only(right: 8),
// //                   decoration: BoxDecoration(
// //                     color: theme.colorScheme.primary,
// //                     borderRadius: BorderRadius.circular(8),
// //                   ),
// //                   child: Text(
// //                     segment.transportLine!,
// //                     style: const TextStyle(
// //                       color: Colors.white,
// //                       fontWeight: FontWeight.bold,
// //                       fontSize: 13,
// //                     ),
// //                   ),
// //                 ),
// //               Expanded(
// //                 child: Text(
// //                   segment.toStop ?? 'Bus segment',
// //                   style: const TextStyle(
// //                     fontWeight: FontWeight.w600,
// //                     fontSize: 15,
// //                   ),
// //                 ),
// //               ),
// //               Text(
// //                 _prettyTime(segment.durrationSeconds),
// //                 style: TextStyle(
// //                   color: theme.colorScheme.primary,
// //                   fontWeight: FontWeight.w500,
// //                 ),
// //               ),
// //             ],
// //           ),
// //           if (segment.fromStop != null)
// //             Padding(
// //               padding: const EdgeInsets.only(top: 2.0),
// //               child: Text(
// //                 'From: ${segment.fromStop}',
// //                 style: TextStyle(
// //                   color: Colors.grey.shade700,
// //                   fontSize: 13,
// //                 ),
// //               ),
// //             ),
// //         ],
// //       );
// //     } else {
// //       return Row(
// //         children: [
// //           Icon(Icons.directions_walk, size: 16, color: Colors.grey.shade700),
// //           const SizedBox(width: 8),
// //           Expanded(
// //             child: Text(
// //               'Walk ${_prettyTime(segment.durrationSeconds)} (${_prettyDistance(segment.distanceMeters)})',
// //               style: const TextStyle(fontSize: 14, fontWeight: FontWeight.w500),
// //             ),
// //           ),
// //         ],
// //       );
// //     }
// //   }

// //   String _prettyTime(int seconds) {
// //     final mins = (seconds / 60).round();
// //     return '$mins min';
// //   }

// //   String _prettyDistance(double meters) {
// //     return meters >= 1000
// //         ? '${(meters / 1000).toStringAsFixed(1)} km'
// //         : '${meters.round()} m';
// //   }
// // }

// // class RouteDetailsSheet extends StatelessWidget {
// //   final RouteData? data;
// //   final VoidCallback onClose;
// //   final String Function(RouteData?) deriveStartName;
// //   final String Function(RouteData?) deriveEndName;

// //   const RouteDetailsSheet({
// //     Key? key,
// //     required this.data,
// //     required this.onClose,
// //     required this.deriveStartName,
// //     required this.deriveEndName,
// //   }) : super(key: key);

// //   @override
// //   Widget build(BuildContext context) {
// //     final segs = data?.segments ?? const <RouteSegment>[];
// //     return Material(
// //       color: Colors.white,
// //       elevation: 8,
// //       clipBehavior: Clip.antiAlias,
// //       shape: const RoundedRectangleBorder(
// //         borderRadius: BorderRadius.vertical(top: Radius.circular(28)),
// //       ),
// //       child: SafeArea(
// //         top: false,
// //         bottom: false,
// //         child: Column(
// //           crossAxisAlignment: CrossAxisAlignment.start,
// //           children: [
// //             Padding(
// //               padding: const EdgeInsets.fromLTRB(20, 12, 20, 0),
// //               child: Row(
// //                 children: [
// //                   Expanded(
// //                     child: Text(
// //                       'Route details',
// //                       style: Theme.of(context).textTheme.titleLarge!.copyWith(
// //                             fontWeight: FontWeight.w700,
// //                           ),
// //                     ),
// //                   ),
// //                   Container(
// //                     width: 36,
// //                     height: 36,
// //                     decoration: BoxDecoration(
// //                       color: Colors.grey.shade200,
// //                       shape: BoxShape.circle,
// //                     ),
// //                     child: IconButton(
// //                       padding: EdgeInsets.zero,
// //                       icon: const Icon(Icons.close, size: 18),
// //                       splashRadius: 18,
// //                       onPressed: onClose,
// //                     ),
// //                   ),
// //                 ],
// //               ),
// //             ),
// //             const SizedBox(height: 24),
// //             Expanded(
// //               child: SingleChildScrollView(
// //                 padding: const EdgeInsets.fromLTRB(20, 0, 20, 28),
// //                 child: Builder(
// //                   builder: (ctx) {
// //                     if (segs.isEmpty) {
// //                       return Padding(
// //                         padding: const EdgeInsets.symmetric(vertical: 16),
// //                         child: Center(
// //                           child: Text('No route segments', style: Theme.of(ctx).textTheme.bodyMedium),
// //                         ),
// //                       );
// //                     }
// //                     return Column(
// //                       crossAxisAlignment: CrossAxisAlignment.start,
// //                       children: [
// //                         _RouteEndpointTile(
// //                           label: 'Start',
// //                           location: deriveStartName(data),
// //                           isFirst: true,
// //                           isLast: false,
// //                         ),
// //                         for (int i = 0; i < segs.length; i++)
// //                           if (!(i > 0 &&
// //                               segs[i].mode == TravelMode.walk &&
// //                               segs[i - 1].mode == TravelMode.walk &&
// //                               segs[i].distanceMeters == segs[i - 1].distanceMeters &&
// //                               segs[i].durrationSeconds == segs[i - 1].durrationSeconds))
// //                             _SegmentTimelineTile(
// //                               segment: segs[i],
// //                               isFirst: false,
// //                               isLast: false,
// //                             ),
// //                         _RouteEndpointTile(
// //                           label: 'End',
// //                           location: deriveEndName(data),
// //                           isFirst: false,
// //                           isLast: true,
// //                         ),
// //                       ],
// //                     );
// //                   },
// //                 ),
// //               ),
// //             ),
// //           ],
// //         ),
// //       ),
// //     );
// //   }
// // }
